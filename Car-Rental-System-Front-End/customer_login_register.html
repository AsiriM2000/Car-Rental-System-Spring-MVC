<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Document Title
        ============================================= -->
    <title>Easy Car Rental</title>

    <!-- Document Title Image
       ============================================= -->
    <link href="../assets/img/admin/car.png" rel="icon">

    <!-- Stylesheets
      ============================================= -->
    <link href="assets/css/customer.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css" rel="stylesheet">

    <!-- Meta tags
       ============================================= -->
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

</head>
<body>
<!--Header-->
<header>
    <a class="logo " href="#"><img style=""></a>
    <div class="bx bx-menu" id="menu-icon"></div>
    <ul class="navbar">
        <li><a href="#home">Home</a></li>
        <li><a href="#ride">Ride</a></li>
        <li><a href="#services">Car</a></li>
        <li><a href="#about">About</a></li>
    </ul>
    <div class="header-btn">
        <a class="sign-up" onclick="document.getElementById('id02').style.display='block'" style="width:auto;">Sign
            Up</a>
        <a class="sign-in" onclick="document.getElementById('id01').style.display='block'" style="width:auto;">Sign
            In</a>
    </div>
</header>
<!--Home-->
<section class="home" id="home">
    <div class="content">
        <h4>Hello,</h4>
        <h1>Looking to<span>Rent a Car</span></h1>
        <h3>Easy Car Rental(Pvt)Ltd.</h3>
        <div class="inputMail">
            <form>
                <input id="mail" name="email" placeholder="Enter Your Email" type="email">
                <input name="submit" type="button" value="Lets Start">
            </form>
        </div>
    </div>
</section>

<!--Ride-->
<section class="ride" id="ride">
    <div class="heading">
        <h1>Rebut with 3 Easy steps</h1>
    </div>
    <div class="ride-container">
        <div class="box">
            <i class='bx bxs-map'></i>
            <h2>Choose A Location</h2>
            <p>Select your desired location.</p>
        </div>

        <div class="box">
            <i class='bx bxs-calendar-check'></i>
            <h2>Pick-Up Date</h2>
            <p>Select the date of vehicle pickup</p>
        </div>

        <div class="box">
            <i class='bx bxs-calendar-star'></i>
            <h2>Book A Car</h2>
            <p>Book the vehicle of your choice</p>
        </div>
    </div>
</section>

<!-- services-->
<section class="services" id="services">
    <div class="heading">
        <h1>Buy top quality cars</h1>
    </div>
    <div class="services-container">
        <div class="box">
            <div class="box-img">
                <img alt="" src="./assets/img/carImage/Jaguar_F-Pace_P400_R-Dynamic_S_2022.jpg">
            </div>
            <p>2023</p>
            <h3>Jaguar R-Dynamic S 2022</h3>
        </div>

        <div class="box">
            <div class="box-img">
                <img alt="" src="./assets/img/carImage/BMW_X5_FCEV_2022.jpg">
            </div>
            <p>2023</p>
            <h3>BMW X5 FCEV 2022</h3>
        </div>

        <div class="box">
            <div class="box-img">
                <img alt="" src="./assets/img/carImage/Suzuki_Alto_K10_2022.jpg">
            </div>
            <p>2023</p>
            <h3>Suzuki Alto K10 2022</h3>
        </div>

        <div class="box">
            <div class="box-img">
                <img alt="" src="./assets/img/carImage/Honda_HR-V_VTi_2022.jpg">
            </div>
            <p>2023</p>
            <h3>Honda HR-V VTi 2022</h3>
        </div>

        <div class="box">
            <div class="box-img">
                <img alt="" src="./assets/img/carImage/Nissan_Rogue_2022.jpg">
            </div>
            <p>2023</p>
            <h3>Nissan Rogue 2022</h3>
        </div>
    </div>
</section>

<!--About-->
<section class="about" id="about">
    <div class="heading">
        <h1>About Us</h1>
    </div>
    <div class="about-container">
        <div class="about-img">
            <img alt="" src="./assets/img/carImage/about.png">
        </div>
        <div class="about-text">
            <p>Easy Car Rental is an ongoing Srilanka success story. Our guiding principles, and humble beginning,
                revolve around personal honesty and integrity. We believe in strengthening our communities one
                neighborhood at a time, serving our customers as if they were our family, and rewarding hard work. These
                things are as true today as they were when we were founded in 2003.</p>

            <p> We take an active role in sustainability, not only because itâ€™s smart for our business, but because we
                believe in making the world a better place for future generations. Because of our size, we are in a
                unique position to foster innovation, advance research and test market-driven solutions.</p>
        </div>
    </div>
</section>

<!--Design-->
<div class="copyright">
    <p>&#169; Design By : <span style="color:#d58700;">Asiri</span> Madhusanka</p>
</div>

<!--Login-->
<div class="modal" id="id01">
    <form class="modal-content animate" id="loginForm">
        <div class="imgcontainer">
            <span class="close" onclick="document.getElementById('id01').style.display='none'" title="Close Modal">&times;</span>
            <img alt="Avatar" class="avatar" src="./assets/img/login-img.png">
            <p>Use your registered email and password</p>
        </div>

        <div class="container">
            <label for="lusername"><b>Username</b></label>
            <input id="lusername" name="lusername" placeholder="Enter Username" required type="text"/>

            <label for="lpassword"><b>Password</b></label>
            <input id="lpassword" name="lusername" placeholder="Enter Password" required type="password"/>

            <button id="logBtn" type="button">Login</button>
        </div>
    </form>
</div>


<!--SignUp-->
<div class="modal" id="id02">
    <span class="close" onclick="document.getElementById('id02').style.display='none'"
          title="Close Modal">&times;</span>
    <form class="modal-content animate">
        <div class="imgcontainer">
            <span class="close" onclick="document.getElementById('id02').style.display='none'" title="Close Modal">&times;</span>
        </div>
        <div class="container">
            <h1>Sign Up</h1>
            <hr>
            <br>
            <div class="mb-3">
                <input class="form-control" id="email" name="email" placeholder="Enter Email" type="text">
                <span class="control-error" id="lblCusEmail"></span>
            </div>

            <div class="mb-3">
                <input class="form-control" id="name" name="name" placeholder="Enter Name" type="text">
                <span class="control-error" id="lblCusName"></span>
            </div>

            <div class="mb-3">
                <input class="form-control" id="address" name="address" placeholder="Enter Address" type="text">
                <span class="control-error" id="lblCusAddress"></span>
            </div>

            <div class="mb-3">
                <input class="form-control" id="nicNum" name="nic" placeholder="Enter NIC Number" type="text">
                <span class="control-error" id="lblCusNic"></span>
            </div>

            <label class="btn" for="nicImg">Select NIC Image</label>
            <input class="form-control" id="nicImg" name="myFile" type="file">

            <div class="mb-3">
                <input class="form-control" id="drivingNum" name="license" placeholder="Enter License Number"
                       type="text">
                <span class="control-error" id="lblCusLicense"></span>
            </div>

            <div class="mb-3">
                <input class="form-control" id="contact" name="contact" placeholder="Enter Contact Number" type="text">
                <span class="control-error" id="lblCusContact"></span>
            </div>

            <div class="mb-3">
                <input class="form-control" id="password" name="password" placeholder="Enter Password" type="password">
                <span class="control-error" id="lblCusPassword"></span>
            </div>

            <div class="clearfix">
                <button id="signupBtn" type="button">Sign Up</button>
            </div>
        </div>
    </form>
</div>

<script src="assets/js/jquery-3.6.1.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<!--validation-->
<script src="assets/js/util/validation/CustomerSignUpValidation.js"></script>
<script type="text/javascript">
    var modal = document.getElementById('id02');
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
    var modal = document.getElementById('id01');
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
    let baseUrl = "http://localhost:8081/Car_Rental_System_Back_End_war/";

    $("#logBtn").click(function () {
        var username = $("#lusername").val();
        var password = $("#lpassword").val();

        $.ajax({
            url: baseUrl + "customer?email=" + username + "&password=" + password,
            dataType: "json",
            success: function (resp) {
                location.href = './pages/rentcar.html';
                clear();
            },
            error: function (error) {
                alert("Username Or Password Incorrect")
            }
        });
    });

    function clear() {
        $("#lusername").val("");
        $("#lpassword").val("");
    }

    $("#signupBtn").click(function () {
        let email = $("#email").val();
        let name = $("#name").val();
        let address = $("#address").val();
        let nicNum = $("#nicNum").val();
        let drivingNum = $("#drivingNum").val();
        let contact = $("#contact").val();
        let password = $("#password").val();

        let customer = {
            nic: nicNum,
            email: email,
            name: name,
            address: address,
            license: drivingNum,
            contact: contact,
            password: password
        }

        console.log(customer)

        $.ajax({
            url: baseUrl + "customer",
            method: "post",
            contentType: "application/json",
            data: JSON.stringify(customer),
            dataType: "json",
            success: function (resp) {
                uploadCustomerImages(nicNum);
                alert(resp.message)
                console.log(resp.message);
                setTextFieldValues("", "", "", "", "", "", "");
            },
            error: function (error) {
                alert(JSON.parse(error.responseText).message);
            }
        });
    });

    function uploadCustomerImages(nicNum) {

        let nicFile = $("#nicImg")[0].files[0];

        let nicFileName = nicNum + "-imageLocation-" + $("#nicImg")[0].files[0].name;

        var data = new FormData();

        data.append("imageLocation", nicFile, nicFileName);

        $.ajax({
            url: baseUrl + "customer/uploadImg/" + nicNum,
            method: "put",
            async: true,
            contentType: false,
            processData: false,
            data: data,
            success: function (resp) {
                console.log("Uploaded");
                alert(resp.message)
            },
            error: function (error) {
                alert(JSON.parse(error.responseText).message);
            }
        });
    }

    // function uploadNicImage() {
    //     var data = new FormData();
    //     let file = $("#nicImg")[0].files[0];
    //     let fileName = $("#nicImg")[0].files[0].name;
    //     data.append("myFile", file, fileName);
    //
    //     $.ajax({
    //         url: baseUrl + "customer/upload",
    //         method: 'post',
    //         async: true,
    //         contentType: false,
    //         processData: false,
    //         data: data,
    //         success: function (resp) {
    //             alert("Successfully Uploaded");
    //         },
    //         error: function (err) {
    //             console.log(err);
    //         }
    //     });
    // }

    function setTextFieldValues(email, name, address, nic, license, contact, password) {
        $("#email").val(email);
        $("#name").val(name);
        $("#address").val(address);
        $("#nicNum").val(nic);
        $("#drivingNum").val(license);
        $("#contact").val(contact);
        $("#password").val(password);
        $("#nicImg").val("");
        $("#drivingImg").val("");
    }

</script>
</body>
</html>